<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool | Godekfredes</title><meta name=keywords content><meta name=description content="+++
title = &ldquo;Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool&rdquo;
date = &ldquo;2021-10-07&rdquo;
author = &ldquo;OpenAI&rdquo;
tags = [&ldquo;cybersecurity&rdquo;, &ldquo;threat hunting&rdquo;, &ldquo;tool development&rdquo;]
image= &ldquo;https://cdn.pixabay.com/photo/2015/11/19/08/32/data-1050150_960_720.jpg&#34;
+++
Are you interested in improving your cybersecurity skills and protecting yourself from online threats? One way to do this is by becoming a threat hunter, a cybersecurity expert who is responsible for identifying and mitigating potential security risks."><meta name=author content="Michael Bird"><link rel=canonical href=https://godekfredes.github.io/posts/how-to-build-a-threat-hunting-tool-in-10-steps-923103/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://godekfredes.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://godekfredes.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://godekfredes.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://godekfredes.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://godekfredes.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool"><meta property="og:description" content="+++
title = &ldquo;Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool&rdquo;
date = &ldquo;2021-10-07&rdquo;
author = &ldquo;OpenAI&rdquo;
tags = [&ldquo;cybersecurity&rdquo;, &ldquo;threat hunting&rdquo;, &ldquo;tool development&rdquo;]
image= &ldquo;https://cdn.pixabay.com/photo/2015/11/19/08/32/data-1050150_960_720.jpg&#34;
+++
Are you interested in improving your cybersecurity skills and protecting yourself from online threats? One way to do this is by becoming a threat hunter, a cybersecurity expert who is responsible for identifying and mitigating potential security risks."><meta property="og:type" content="article"><meta property="og:url" content="https://godekfredes.github.io/posts/how-to-build-a-threat-hunting-tool-in-10-steps-923103/"><meta property="og:image" content="https://godekfredes.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-12-10T00:00:00+00:00"><meta property="article:modified_time" content="2022-12-10T00:00:00+00:00"><meta property="og:site_name" content="Godekfredes"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://godekfredes.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool"><meta name=twitter:description content="+++
title = &ldquo;Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool&rdquo;
date = &ldquo;2021-10-07&rdquo;
author = &ldquo;OpenAI&rdquo;
tags = [&ldquo;cybersecurity&rdquo;, &ldquo;threat hunting&rdquo;, &ldquo;tool development&rdquo;]
image= &ldquo;https://cdn.pixabay.com/photo/2015/11/19/08/32/data-1050150_960_720.jpg&#34;
+++
Are you interested in improving your cybersecurity skills and protecting yourself from online threats? One way to do this is by becoming a threat hunter, a cybersecurity expert who is responsible for identifying and mitigating potential security risks."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://godekfredes.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool","item":"https://godekfredes.github.io/posts/how-to-build-a-threat-hunting-tool-in-10-steps-923103/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool","name":"Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool","description":"+++\ntitle = \u0026ldquo;Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool\u0026rdquo;\ndate = \u0026ldquo;2021-10-07\u0026rdquo;\nauthor = \u0026ldquo;OpenAI\u0026rdquo;\ntags = [\u0026ldquo;cybersecurity\u0026rdquo;, \u0026ldquo;threat hunting\u0026rdquo;, \u0026ldquo;tool development\u0026rdquo;]\nimage= \u0026ldquo;https://cdn.pixabay.com/photo/2015/11/19/08/32/data-1050150_960_720.jpg\u0026quot;\n+++\nAre you interested in improving your cybersecurity skills and protecting yourself from online threats? One way to do this is by becoming a threat hunter, a cybersecurity expert who is responsible for identifying and mitigating potential security risks.","keywords":[],"articleBody":" +++\ntitle = “Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool”\ndate = “2021-10-07”\nauthor = “OpenAI”\ntags = [“cybersecurity”, “threat hunting”, “tool development”]\nimage= “https://cdn.pixabay.com/photo/2015/11/19/08/32/data-1050150_960_720.jpg\"\n+++\nAre you interested in improving your cybersecurity skills and protecting yourself from online threats? One way to do this is by becoming a threat hunter, a cybersecurity expert who is responsible for identifying and mitigating potential security risks.\nIn this article, we will show you how to build your own threat hunting tool with these simple 10 steps.\nStep 1: Define Your Goals and Requirements\nThe first step is to determine what goals you want to achieve with your threat hunting tool. What types of threats do you want to detect? Do you want to focus on malware, phishing, or other types of attacks?\nStep 2: Choose Your Platform\nThe platform will depend on your goals and requirements. Some platforms are better suited for specific types of threats, while others are more general. For example, open-source platforms like Snort and Suricata are great for detecting network threats, while tools like YARA and ClamAV are useful for finding malware.\nStep 3: Choose Your Programming Language\nThe most common programming languages for building threat hunting tools are Python, C++, and Java. Choose the language that you have experience with and that best meets your goals and requirements.\nStep 4: Start Coding\nBegin customizing your threat hunting tool to specific threats you are interested in detecting. You can start with open-source code from available repositories on Github, and build on that codebase.\nStep 5: Implement Scanners and Sensors\nScanners and sensors are essential for detecting threats. Add network scanners, such as Nmap, or host-based sensors, such as Osquery, to your tool to increase your detection capabilities.\nStep 6: Create Rules for Detecting Threats\nRules determine when your tool should alert you to potential threats. For example, you can create a rule to alert you when a certain network port is being accessed or when a specific file is downloaded.\nStep 7: Create Dashboards\nDashboards are a great way to visualize the data collected by your tool. You can use tools like Kibana or Grafana to create dashboards that show you relevant data in real-time.\nStep 8: Create a Reporting System\nReporting is essential for tracking your tool’s effectiveness and identifying any areas that need improvement. Create a reporting system that allows you to filter and search through data, as well as export reports for further analysis.\nStep 9: Test Your Tool\nBefore deploying your tool, be sure to test it extensively to ensure that it is effective and accurate. You can use test datasets to simulate different types of threats and ensure that your tool detects them.\nStep 10: Deploy Your Tool\nOnce you are confident in the effectiveness of your tool, you can deploy it to your organization’s network. Be sure to configure it properly and monitor your tool’s effectiveness over time.\nBuilding your own threat hunting tool is an excellent way to improve your cybersecurity skills and protect your organization from potential threats. By following these simple 10 steps, you can become a cyber sleuth capable of detecting and mitigating any security risks that come your way.\nThe ideal threat-hunting tool should be able to analyze vast amounts of data, especially system logs and system analytics. There are many different application suites out there that can do exactly that, ranging from free and open-source projects all the way to enterprise-grade products that cost thousands of dollars. Whichever route you decide to take, you will have to factor in costs and functionality that will suit your particular needs.\nDeciding on a Platform to Build From There are many different threat-hunting platforms that you can choose to build your tool from. For our example, we will be using the platform formerly known as ELK Stack, now called Elastic Stack. Elastic Stack is comprised of multiple tools, which are:\nElasticsearch: A distributed JSON-based search and analytics engine that has been designed to scale horizontally and is both reliable and easy to manage Logstash: This is the point at which data ingestion takes place and has many different plugins available Kirbana: Lets you visualize your data and turn it into a valuable source of information that’s easy to navigate Beats: This is the end-point application that ships data back to Logstash and Elasticsearch\nUsing all of these components together allows you to monitor your IT environment with a purposefully-designed threat-hunting tool that you can build yourself, with no programming required. If you have the skills to code, then you could even build your own plugins or modules that interact with Elasticsearch, thanks to its RestfulAPIs and JSON components. It has a large community that has written many different client software applications. See the link in Sources below!\nUnderstand Log Flow In order to use the tool and build it successfully, we need to understand how it collects data. Logs are created in many different locations across the network and then directed to the Elastic Stack suite. These are then sorted through according to your parameters by the Logstash component; the results of this sorting are then sent to Elasticsearch, which searches the results. From there, the search results are compiled into a human-readable format that is easier to make sense of. It is this picture that allows you to find out if there is any unusual or suspicious activity on your systems. From here, even more data can be extracted using different filters. Now that we know how each component of our threat hunting tool works, we can look at what is needed for us to download, install and configure Elasticsearch for ourselves.\nGetting Started The first port of call is the Elastic Stack download page. From here, users can choose the appropriate packages that pertain to their operating systems and requirements. You need to install some components on the server, and some components on the clients that you wish to monitor. For our install we will be using a few different packages in order to get a monitoring solution up and running, and the example machine will be running Windows Server 2012.\nThe server components Elasticsearch Logstash Kibana\nThe client components Filebeat Packetbeat Metriclogbeat Winlogbeat\nOptional packages Non-Sucking Service Manager (NSSM) Java WinPcap\nThere are other packages available, but these are not necessary for this install. Simple overviews of the installation process can be found on elastic.co.\nInstall the Components Step 1 Download aforementioned packages from elastic.co and save them to a convenient location. Once completed, you should have a similar collection to this, depending on your OS. You should make sure that Java is installed and up-to-date before starting with this installation.\nStep 2 Start installing the packages. We start with Elasticsearch. Simply extract the contents of the zip file into a folder and then navigate to the bin folder. Execute the elasticsearch.bat file and allow the system to install. Once complete, you will be able to open a browser and navigate to http://127.0.0.1:9200 where you will be greeted with the following.\nStep 3 Next, navigate to the folder where Kibana has been extracted and open the bin folder. Execute the kibana.bat file to begin the installation. To check if Kibana has installed properly, navigate in a browser to http://127.0.0.1:5601 where you should see the below screen.\nStep 4 The next step is to install and run Logstash. Navigate to the folder where it has been extracted and then execute the following command: logstash -e ‘input { stdin { } } output { stdout {} }’ . This command will let you echo text from the command prompt straight into Logstash. If you type in any string of letters or numbers, you will then see them being returned to you as a log entry. See below example. You have now successfully installed the three key components for your threat-hunting tool build, and now all you need to do is begin collecting data!\nStep 5 In order to begin collecting data, you need to install all of the endpoint collection applications. In the case of Elastic Stack, these come from the Beats, which are installable, separate components of Elastic Stack. We start by installing Filebeat.\nStep 6 Create a directory called C:Program FilesFilebeat. Browse to the location where you extracted the Filebeat zip file and then copy the contents to C:Program FilesFilebeat.\nStep 7 Next, open Powershell as administrator and run the following command: PS \u003e cd ‘C:Program FilesFilebeat’ PS \u003e C:Program FilesFilebeat\u003e .install-service-filebeat.ps1\nStep 8 Begin configuring Filebeat. An in-depth guide to accomplishing that can be found on elastic.co (see Sources) and will allow you to make the changes that you need to start monitoring relevant data on your network.\nStep 9 If we plan on using the graphical capabilities of Kibana, then we will need to configure Packetbeat to utilize Kibana. Luckily, Packetbeat comes with preconfigured example dashboards that can be used to visualize all of the relevant data. But before we can do that, we need to create an index pattern that will use all of this data. Run Setup and add the index pattern Packetbeat-*. A full installation guide for Packetbeat can be found under Sources.\nStep 10 The final step is to start the Filebeat service, which we do via Powershell: PS C:Program FilesFilebeat\u003e Start-Service Filebeat If this has been done successfully then your Elastic Stack installation will now be collecting data from Filebeat! Congratulations!\nConclusion As we have seen, creating a threat-hunting tool doesn’t need to be difficult! This is just one choice of many, and the product that you decide to use in your own environment or test lab will depend on what data you wish to collect, and how you need to process all of this information. The applicability of each approach will depend entirely upon the threat being targeted and the intended outcome of each search. Threat-hunting encompasses many different disciplines within cybersecurity, and as such requires many different skills to be mastered and combined with certifications, not to mention work experience. Threat hunting is becoming a highly sought-after skill for modern businesses who are discovering the value of having the in-house skills to deal with potential threats to their operations. Be sure to check out InfoSec Institute’s course listing here to get your threat-hunting career started! Sources Installing the Elastic Stack, elastic.co Getting Started with Filebeat, elastic.co Community Contributed Clients, elastic.co Configure Packetbeat, elastic.co Set up the Kibana dashboards, elastic.co\n","wordCount":"1752","inLanguage":"en","datePublished":"2022-12-10T00:00:00Z","dateModified":"2022-12-10T00:00:00Z","author":{"@type":"Person","name":"Michael Bird"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://godekfredes.github.io/posts/how-to-build-a-threat-hunting-tool-in-10-steps-923103/"},"publisher":{"@type":"Organization","name":"Godekfredes","logo":{"@type":"ImageObject","url":"https://godekfredes.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://godekfredes.github.io/ accesskey=h title="Godekfredes (Alt + H)"><img src=https://godekfredes.github.io/apple-touch-icon.png alt aria-label=logo height=35>Godekfredes</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://godekfredes.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://godekfredes.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://godekfredes.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://godekfredes.github.io/posts/>Posts</a></div><h1 class=post-title>Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool</h1><div class=post-meta><span title='2022-12-10 00:00:00 +0000 UTC'>December 10, 2022</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1752 words&nbsp;·&nbsp;Michael Bird</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#deciding-on-a-platform-to-build-from>Deciding on a Platform to Build From</a></li><li><a href=#understand-log-flow>Understand Log Flow</a></li><li><a href=#getting-started>Getting Started</a><ul><li><a href=#the-server-components>The server components</a></li><li><a href=#the-client-components>The client components</a></li><li><a href=#optional-packages>Optional packages</a></li></ul></li><li><a href=#install-the-components>Install the Components</a><ul><li><a href=#step-1>Step 1</a></li><li><a href=#step-2>Step 2</a></li><li><a href=#step-3>Step 3</a></li><li><a href=#step-4>Step 4</a></li><li><a href=#step-5>Step 5</a></li><li><a href=#step-6>Step 6</a></li><li><a href=#step-7>Step 7</a></li><li><a href=#step-8>Step 8</a></li><li><a href=#step-9>Step 9</a></li><li><a href=#step-10>Step 10</a></li></ul></li><li><a href=#conclusion>Conclusion</a><ul><li><a href=#sources>Sources</a></li></ul></li></ul></nav></div></details></div><div class=post-content><hr><p>+++</p><p>title = &ldquo;Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool&rdquo;</p><p>date = &ldquo;2021-10-07&rdquo;</p><p>author = &ldquo;OpenAI&rdquo;</p><p>tags = [&ldquo;cybersecurity&rdquo;, &ldquo;threat hunting&rdquo;, &ldquo;tool development&rdquo;]</p><p>image= &ldquo;<a href=https://cdn.pixabay.com/photo/2015/11/19/08/32/data-1050150_960_720.jpg%22>https://cdn.pixabay.com/photo/2015/11/19/08/32/data-1050150_960_720.jpg"</a></p><p>+++</p><p>Are you interested in improving your cybersecurity skills and protecting yourself from online threats? One way to do this is by becoming a threat hunter, a cybersecurity expert who is responsible for identifying and mitigating potential security risks.</p><p>In this article, we will show you how to build your own threat hunting tool with these simple 10 steps.</p><p>Step 1: Define Your Goals and Requirements</p><p>The first step is to determine what goals you want to achieve with your threat hunting tool. What types of threats do you want to detect? Do you want to focus on malware, phishing, or other types of attacks?</p><p>Step 2: Choose Your Platform</p><p>The platform will depend on your goals and requirements. Some platforms are better suited for specific types of threats, while others are more general. For example, open-source platforms like Snort and Suricata are great for detecting network threats, while tools like YARA and ClamAV are useful for finding malware.</p><p>Step 3: Choose Your Programming Language</p><p>The most common programming languages for building threat hunting tools are Python, C++, and Java. Choose the language that you have experience with and that best meets your goals and requirements.</p><p>Step 4: Start Coding</p><p>Begin customizing your threat hunting tool to specific threats you are interested in detecting. You can start with open-source code from available repositories on Github, and build on that codebase.</p><p>Step 5: Implement Scanners and Sensors</p><p>Scanners and sensors are essential for detecting threats. Add network scanners, such as Nmap, or host-based sensors, such as Osquery, to your tool to increase your detection capabilities.</p><p>Step 6: Create Rules for Detecting Threats</p><p>Rules determine when your tool should alert you to potential threats. For example, you can create a rule to alert you when a certain network port is being accessed or when a specific file is downloaded.</p><p>Step 7: Create Dashboards</p><p>Dashboards are a great way to visualize the data collected by your tool. You can use tools like Kibana or Grafana to create dashboards that show you relevant data in real-time.</p><p>Step 8: Create a Reporting System</p><p>Reporting is essential for tracking your tool’s effectiveness and identifying any areas that need improvement. Create a reporting system that allows you to filter and search through data, as well as export reports for further analysis.</p><p>Step 9: Test Your Tool</p><p>Before deploying your tool, be sure to test it extensively to ensure that it is effective and accurate. You can use test datasets to simulate different types of threats and ensure that your tool detects them.</p><p>Step 10: Deploy Your Tool</p><p>Once you are confident in the effectiveness of your tool, you can deploy it to your organization’s network. Be sure to configure it properly and monitor your tool’s effectiveness over time.</p><p>Building your own threat hunting tool is an excellent way to improve your cybersecurity skills and protect your organization from potential threats. By following these simple 10 steps, you can become a cyber sleuth capable of detecting and mitigating any security risks that come your way.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/xxvAWGNgq3w style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>The ideal threat-hunting tool should be able to analyze vast amounts of data, especially system logs and system analytics. There are many different application suites out there that can do exactly that, ranging from free and open-source projects all the way to enterprise-grade products that cost thousands of dollars. Whichever route you decide to take, you will have to factor in costs and functionality that will suit your particular needs.</p><h2 id=deciding-on-a-platform-to-build-from>Deciding on a Platform to Build From<a hidden class=anchor aria-hidden=true href=#deciding-on-a-platform-to-build-from>#</a></h2><p>There are many different threat-hunting platforms that you can choose to build your tool from. For our example, we will be using the platform formerly known as ELK Stack, now called Elastic Stack. Elastic Stack is comprised of multiple tools, which are:</p><p>Elasticsearch: A distributed JSON-based search and analytics engine that has been designed to scale horizontally and is both reliable and easy to manage
Logstash: This is the point at which data ingestion takes place and has many different plugins available
Kirbana: Lets you visualize your data and turn it into a valuable source of information that’s easy to navigate
Beats: This is the end-point application that ships data back to Logstash and Elasticsearch</p><p>Using all of these components together allows you to monitor your IT environment with a purposefully-designed threat-hunting tool that you can build yourself, with no programming required. If you have the skills to code, then you could even build your own plugins or modules that interact with Elasticsearch, thanks to its RestfulAPIs and JSON components. It has a large community that has written many different client software applications. See the link in Sources below!</p><h2 id=understand-log-flow>Understand Log Flow<a hidden class=anchor aria-hidden=true href=#understand-log-flow>#</a></h2><p>In order to use the tool and build it successfully, we need to understand how it collects data. Logs are created in many different locations across the network and then directed to the Elastic Stack suite. These are then sorted through according to your parameters by the Logstash component; the results of this sorting are then sent to Elasticsearch, which searches the results. From there, the search results are compiled into a human-readable format that is easier to make sense of.
It is this picture that allows you to find out if there is any unusual or suspicious activity on your systems. From here, even more data can be extracted using different filters.
Now that we know how each component of our threat hunting tool works, we can look at what is needed for us to download, install and configure Elasticsearch for ourselves.</p><h2 id=getting-started>Getting Started<a hidden class=anchor aria-hidden=true href=#getting-started>#</a></h2><p>The first port of call is the Elastic Stack download page. From here, users can choose the appropriate packages that pertain to their operating systems and requirements. You need to install some components on the server, and some components on the clients that you wish to monitor. For our install we will be using a few different packages in order to get a monitoring solution up and running, and the example machine will be running Windows Server 2012.</p><h3 id=the-server-components>The server components<a hidden class=anchor aria-hidden=true href=#the-server-components>#</a></h3><p>Elasticsearch
Logstash
Kibana</p><h3 id=the-client-components>The client components<a hidden class=anchor aria-hidden=true href=#the-client-components>#</a></h3><p>Filebeat
Packetbeat
Metriclogbeat
Winlogbeat</p><h3 id=optional-packages>Optional packages<a hidden class=anchor aria-hidden=true href=#optional-packages>#</a></h3><p>Non-Sucking Service Manager (NSSM)
Java
WinPcap</p><p>There are other packages available, but these are not necessary for this install. Simple overviews of the installation process can be found on elastic.co.</p><h2 id=install-the-components>Install the Components<a hidden class=anchor aria-hidden=true href=#install-the-components>#</a></h2><h3 id=step-1>Step 1<a hidden class=anchor aria-hidden=true href=#step-1>#</a></h3><p>Download aforementioned packages from elastic.co and save them to a convenient location. Once completed, you should have a similar collection to this, depending on your OS. You should make sure that Java is installed and up-to-date before starting with this installation.</p><h3 id=step-2>Step 2<a hidden class=anchor aria-hidden=true href=#step-2>#</a></h3><p>Start installing the packages. We start with Elasticsearch. Simply extract the contents of the zip file into a folder and then navigate to the bin folder. Execute the elasticsearch.bat file and allow the system to install. Once complete, you will be able to open a browser and navigate to http://127.0.0.1:9200 where you will be greeted with the following.</p><h3 id=step-3>Step 3<a hidden class=anchor aria-hidden=true href=#step-3>#</a></h3><p>Next, navigate to the folder where Kibana has been extracted and open the bin folder. Execute the kibana.bat file to begin the installation. To check if Kibana has installed properly, navigate in a browser to http://127.0.0.1:5601 where you should see the below screen.</p><h3 id=step-4>Step 4<a hidden class=anchor aria-hidden=true href=#step-4>#</a></h3><p>The next step is to install and run Logstash. Navigate to the folder where it has been extracted and then execute the following command: logstash -e ‘input { stdin { } } output { stdout {} }’ . This command will let you echo text from the command prompt straight into Logstash. If you type in any string of letters or numbers, you will then see them being returned to you as a log entry. See below example.
You have now successfully installed the three key components for your threat-hunting tool build, and now all you need to do is begin collecting data!</p><h3 id=step-5>Step 5<a hidden class=anchor aria-hidden=true href=#step-5>#</a></h3><p>In order to begin collecting data, you need to install all of the endpoint collection applications. In the case of Elastic Stack, these come from the Beats, which are installable, separate components of Elastic Stack. We start by installing Filebeat.</p><h3 id=step-6>Step 6<a hidden class=anchor aria-hidden=true href=#step-6>#</a></h3><p>Create a directory called C:Program FilesFilebeat. Browse to the location where you extracted the Filebeat zip file and then copy the contents to C:Program FilesFilebeat.</p><h3 id=step-7>Step 7<a hidden class=anchor aria-hidden=true href=#step-7>#</a></h3><p>Next, open Powershell as administrator and run the following command:
PS > cd ‘C:Program FilesFilebeat’
PS > C:Program FilesFilebeat> .install-service-filebeat.ps1</p><h3 id=step-8>Step 8<a hidden class=anchor aria-hidden=true href=#step-8>#</a></h3><p>Begin configuring Filebeat. An in-depth guide to accomplishing that can be found on elastic.co (see Sources) and will allow you to make the changes that you need to start monitoring relevant data on your network.</p><h3 id=step-9>Step 9<a hidden class=anchor aria-hidden=true href=#step-9>#</a></h3><p>If we plan on using the graphical capabilities of Kibana, then we will need to configure Packetbeat to utilize Kibana. Luckily, Packetbeat comes with preconfigured example dashboards that can be used to visualize all of the relevant data. But before we can do that, we need to create an index pattern that will use all of this data.
Run Setup and add the index pattern Packetbeat-*. A full installation guide for Packetbeat can be found under Sources.</p><h3 id=step-10>Step 10<a hidden class=anchor aria-hidden=true href=#step-10>#</a></h3><p>The final step is to start the Filebeat service, which we do via Powershell:
PS C:Program FilesFilebeat> Start-Service Filebeat
If this has been done successfully then your Elastic Stack installation will now be collecting data from Filebeat! Congratulations!</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>As we have seen, creating a threat-hunting tool doesn’t need to be difficult! This is just one choice of many, and the product that you decide to use in your own environment or test lab will depend on what data you wish to collect, and how you need to process all of this information. The applicability of each approach will depend entirely upon the threat being targeted and the intended outcome of each search.
Threat-hunting encompasses many different disciplines within cybersecurity, and as such requires many different skills to be mastered and combined with certifications, not to mention work experience. Threat hunting is becoming a highly sought-after skill for modern businesses who are discovering the value of having the in-house skills to deal with potential threats to their operations. Be sure to check out InfoSec Institute’s course listing here to get your threat-hunting career started!
 </p><h3 id=sources>Sources<a hidden class=anchor aria-hidden=true href=#sources>#</a></h3><p>Installing the Elastic Stack, elastic.co
Getting Started with Filebeat, elastic.co
Community Contributed Clients, elastic.co
Configure Packetbeat, elastic.co
Set up the Kibana dashboards, elastic.co</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://godekfredes.github.io/posts/how-to-change-themes-for-individual-chats-on-telegram33220/><span class=title>« Prev</span><br><span>Transform Your Telegram Chats with this Genius Theme Trick - Learn How to Customize Them to Perfection!</span></a>
<a class=next href=https://godekfredes.github.io/posts/how-to-compress-images-online-without-losing-quality1630026/><span class=title>Next »</span><br><span>Unlock the Secret to High-Quality Image Compression with this Online Tool - Never Sacrifice Quality Again!</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool on twitter" href="https://twitter.com/intent/tweet/?text=Unleash%20Your%20Inner%20Cyber%20Sleuth%20with%20This%20Simple%2010-Step%20Guide%20to%20Building%20Your%20Own%20Threat%20Hunting%20Tool&url=https%3a%2f%2fgodekfredes.github.io%2fposts%2fhow-to-build-a-threat-hunting-tool-in-10-steps-923103%2f&hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fgodekfredes.github.io%2fposts%2fhow-to-build-a-threat-hunting-tool-in-10-steps-923103%2f&title=Unleash%20Your%20Inner%20Cyber%20Sleuth%20with%20This%20Simple%2010-Step%20Guide%20to%20Building%20Your%20Own%20Threat%20Hunting%20Tool&summary=Unleash%20Your%20Inner%20Cyber%20Sleuth%20with%20This%20Simple%2010-Step%20Guide%20to%20Building%20Your%20Own%20Threat%20Hunting%20Tool&source=https%3a%2f%2fgodekfredes.github.io%2fposts%2fhow-to-build-a-threat-hunting-tool-in-10-steps-923103%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fgodekfredes.github.io%2fposts%2fhow-to-build-a-threat-hunting-tool-in-10-steps-923103%2f&title=Unleash%20Your%20Inner%20Cyber%20Sleuth%20with%20This%20Simple%2010-Step%20Guide%20to%20Building%20Your%20Own%20Threat%20Hunting%20Tool"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgodekfredes.github.io%2fposts%2fhow-to-build-a-threat-hunting-tool-in-10-steps-923103%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool on whatsapp" href="https://api.whatsapp.com/send?text=Unleash%20Your%20Inner%20Cyber%20Sleuth%20with%20This%20Simple%2010-Step%20Guide%20to%20Building%20Your%20Own%20Threat%20Hunting%20Tool%20-%20https%3a%2f%2fgodekfredes.github.io%2fposts%2fhow-to-build-a-threat-hunting-tool-in-10-steps-923103%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Unleash Your Inner Cyber Sleuth with This Simple 10-Step Guide to Building Your Own Threat Hunting Tool on telegram" href="https://telegram.me/share/url?text=Unleash%20Your%20Inner%20Cyber%20Sleuth%20with%20This%20Simple%2010-Step%20Guide%20to%20Building%20Your%20Own%20Threat%20Hunting%20Tool&url=https%3a%2f%2fgodekfredes.github.io%2fposts%2fhow-to-build-a-threat-hunting-tool-in-10-steps-923103%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://godekfredes.github.io/>Godekfredes</a></span></footer><script type=text/javascript src=//normallydemandedalter.com/48/f2/62/48f262e63869c6b4229e3455c07958bc.js></script>
<script type=text/javascript>var _Hasync=_Hasync||[];_Hasync.push(["Histats.start","1,4695461,4,0,0,0,00010000"]),_Hasync.push(["Histats.fasi","1"]),_Hasync.push(["Histats.track_hits",""]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//s10.histats.com/js15_as.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><noscript><a href=/ target=_blank><img src=//sstatic1.histats.com/0.gif?4695461&101 alt border=0></a></noscript><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>